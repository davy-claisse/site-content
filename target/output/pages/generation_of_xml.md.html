<div class="page-header">
<h1>
Generation of xml
</h1>
</div>
<p>Often developers need to generate XML from models. In more complicated situation, they probably would write some XML generation code. However under simple condition, classes Model and LazyList already provide the basics.</p>
<h2 id="generate-simple-xml-from-a-model">Generate simple XML from a model</h2>
<p>Here is code that will provide stock XML from a model:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
</pre></td><td class="sourceCode"><pre><code class="sourceCode java">Person p  = (Person)Person.<span class="fu">findById</span>(<span class="dv">1</span>);
String xml = p.<span class="fu">toXml</span>(<span class="dv">2</span>, <span class="kw">true</span>);</code></pre></td></tr></table></div>
<p>The XML produced will look something like this:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; <span class="kw">?&gt;</span>
  <span class="kw">&lt;person&gt;</span>
    <span class="kw">&lt;updated_at&gt;</span>2010-11-09 19:02:11.0<span class="kw">&lt;/updated_at&gt;</span>
    <span class="kw">&lt;created_at&gt;</span>2010-11-09 19:02:11.0<span class="kw">&lt;/created_at&gt;</span>
    <span class="kw">&lt;dob&gt;</span>1934-12-01<span class="kw">&lt;/dob&gt;</span>
    <span class="kw">&lt;last_name&gt;</span>Smith<span class="kw">&lt;/last_name&gt;</span>
    <span class="kw">&lt;graduation_date&gt;</span>1954-12-01<span class="kw">&lt;/graduation_date&gt;</span>
    <span class="kw">&lt;name&gt;</span>John<span class="kw">&lt;/name&gt;</span>
    <span class="kw">&lt;id&gt;</span>1<span class="kw">&lt;/id&gt;</span>
  <span class="kw">&lt;/person&gt;</span></code></pre></td></tr></table></div>
<p>The first parameter (2) is a number of spaces for indent, and second whether to add an XML declaration or not.</p>
<h2 id="include-attributes-into-generated-xml">Include attributes into generated XML</h2>
<p>A variation on the example above is to provide a list of attributes that you are interested in, so that only these attributes are included:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
</pre></td><td class="sourceCode"><pre><code class="sourceCode java">Person p  = (Person)Person.<span class="fu">findById</span>(<span class="dv">1</span>);
String xml = p.<span class="fu">toXml</span>(<span class="dv">2</span>, <span class="kw">true</span>, <span class="st">&quot;last_name&quot;</span>, <span class="st">&quot;dob&quot;</span>);</code></pre></td></tr></table></div>
<p>The resulting XML will have nothing but the attributes specified:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; <span class="kw">?&gt;</span>
<span class="kw">&lt;person&gt;</span>
    <span class="kw">&lt;dob&gt;</span>1934-12-01<span class="kw">&lt;/dob&gt;</span>
    <span class="kw">&lt;last_name&gt;</span>Smith<span class="kw">&lt;/last_name&gt;</span>
<span class="kw">&lt;/person&gt;</span></code></pre></td></tr></table></div>
<h2 id="inclusion-of-dependencies">Inclusion of dependencies</h2>
<p>When a model has relationships, the generated XML will loop through them to include their XML into the parent XML as well:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
</pre></td><td class="sourceCode"><pre><code class="sourceCode java">List&lt;User&gt; personList = User.<span class="fu">findAll</span>().<span class="fu">orderBy</span>(<span class="st">&quot;id&quot;</span>).<span class="fu">include</span>(Address.<span class="fu">class</span>);
User u = personList.<span class="fu">get</span>(<span class="dv">0</span>);
String xml = u.<span class="fu">toXml</span>(<span class="dv">2</span>, <span class="kw">true</span>);</code></pre></td></tr></table></div>
<p>result:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; <span class="kw">?&gt;</span>
  <span class="kw">&lt;user&gt;</span>
    <span class="kw">&lt;addresses&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>1<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 31<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>123 Pine St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>1<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>1<span class="kw">&lt;/user_id&gt;</span>
   ...
    truncated for brevity
   ...
    <span class="kw">&lt;/addresses&gt;</span>
    <span class="kw">&lt;email&gt;</span>mmonroe@yahoo.com<span class="kw">&lt;/email&gt;</span>
    <span class="kw">&lt;last_name&gt;</span>Monroe<span class="kw">&lt;/last_name&gt;</span>
    <span class="kw">&lt;id&gt;</span>1<span class="kw">&lt;/id&gt;</span>
    <span class="kw">&lt;first_name&gt;</span>Marilyn<span class="kw">&lt;/first_name&gt;</span>
  <span class="kw">&lt;/user&gt;</span></code></pre></td></tr></table></div>
<h2 id="generate-xml-from-a-resultset">Generate XML from a resultset</h2>
<p>Generating XML from a LazyList is equally easy:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
</pre></td><td class="sourceCode"><pre><code class="sourceCode java">LazyList&lt;User&gt; personList = User.<span class="fu">findAll</span>().<span class="fu">orderBy</span>(<span class="st">&quot;id&quot;</span>).<span class="fu">include</span>(Address.<span class="fu">class</span>);
String xml = personList.<span class="fu">toXml</span>(<span class="dv">2</span>, <span class="kw">true</span>);</code></pre></td></tr></table></div>
<p>An example of generated XML:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; <span class="kw">?&gt;</span>
<span class="kw">&lt;users&gt;</span>
  <span class="kw">&lt;user&gt;</span>
    <span class="kw">&lt;addresses&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>1<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 31<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>123 Pine St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>1<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>1<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 21<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>456 Brook St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>2<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>1<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 32<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>23 Grove St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>3<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
    <span class="kw">&lt;/addresses&gt;</span>
    <span class="kw">&lt;email&gt;</span>mmonroe@yahoo.com<span class="kw">&lt;/email&gt;</span>
    <span class="kw">&lt;last_name&gt;</span>Monroe<span class="kw">&lt;/last_name&gt;</span>
    <span class="kw">&lt;id&gt;</span>1<span class="kw">&lt;/id&gt;</span>
    <span class="kw">&lt;first_name&gt;</span>Marilyn<span class="kw">&lt;/first_name&gt;</span>
  <span class="kw">&lt;/user&gt;</span>
  <span class="kw">&lt;user&gt;</span>
    <span class="kw">&lt;addresses&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>2<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 34<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>143 Madison St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>4<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>2<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 35<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>153 Creek St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>5<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>2<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 36<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>163 Gorge St.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>6<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
      <span class="kw">&lt;address&gt;</span>
        <span class="kw">&lt;user_id&gt;</span>2<span class="kw">&lt;/user_id&gt;</span>
        <span class="kw">&lt;address2&gt;</span>apt 37<span class="kw">&lt;/address2&gt;</span>
        <span class="kw">&lt;state&gt;</span>IL<span class="kw">&lt;/state&gt;</span>
        <span class="kw">&lt;zip&gt;</span>60606<span class="kw">&lt;/zip&gt;</span>
        <span class="kw">&lt;address1&gt;</span>173 Far Side.<span class="kw">&lt;/address1&gt;</span>
        <span class="kw">&lt;id&gt;</span>7<span class="kw">&lt;/id&gt;</span>
        <span class="kw">&lt;city&gt;</span>Springfield<span class="kw">&lt;/city&gt;</span>
      <span class="kw">&lt;/address&gt;</span>
    <span class="kw">&lt;/addresses&gt;</span>
    <span class="kw">&lt;email&gt;</span>jdoe@gmail.com<span class="kw">&lt;/email&gt;</span>
    <span class="kw">&lt;last_name&gt;</span>Doe<span class="kw">&lt;/last_name&gt;</span>
    <span class="kw">&lt;id&gt;</span>2<span class="kw">&lt;/id&gt;</span>
    <span class="kw">&lt;first_name&gt;</span>John<span class="kw">&lt;/first_name&gt;</span>
  <span class="kw">&lt;/user&gt;</span>
<span class="kw">&lt;/users&gt;</span></code></pre></td></tr></table></div>
<p>The two users were generated. Since the include was used, the corresponding children from the ADDRESSES table were queried too for their XML.</p>
