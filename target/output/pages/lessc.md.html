<div class="page-header">
<h1>
Lessc
</h1>
</div>
<p><a href="http://lesscss.org/">Less compiler</a> is a better way to write CSS. ActiveWeb provides a built-in mechanism to generate CSS file on the fly with a use of a Less compiler.</p>
<blockquote>
<p>Less configuration below requires that you install a Less compiler from: <a href="http://lesscss.org/">Less compiler</a></p>
</blockquote>
<p>Here is how to configure:</p>
<h2 id="configure-routes">Configure routes</h2>
<p>First, configure the routes to ignore &quot;/bootstrap.css&quot; route in all environments except development:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
</pre></td><td class="sourceCode"><pre><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> RouteConfig <span class="kw">extends</span> AbstractRouteConfig {
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">init</span>(AppContext appContext) {
        <span class="fu">ignore</span>(<span class="st">&quot;/bootstrap.css&quot;</span>).<span class="fu">exceptIn</span>(<span class="st">&quot;development&quot;</span>);
    }
}</code></pre></td></tr></table></div>
<h2 id="create-controler-for-development-environment">Create controler for development environment</h2>
<p>Then, create a new controller:</p>
<div class="sourceCode"><table class="sourceCode java numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
</pre></td><td class="sourceCode"><pre><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> BootstrapController <span class="kw">extends</span> AbstractLesscController {
    <span class="fu">@Override</span>
    <span class="kw">protected</span> File <span class="fu">getLessFile</span>() {
        <span class="kw">return</span> <span class="kw">new</span> File(<span class="st">&quot;src/main/webapp/less/bootstrap.less&quot;</span>);
    }
}</code></pre></td></tr></table></div>
<p>And override the <code>getLessFile()</code> method to return a location of your main Less file.</p>
<p>Additionally, add a Maven plugin to your pom file:</p>
<h2 id="configuration-for-a-single-less-file">Configuration for a Single LESS file</h2>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;plugin&gt;</span>
    <span class="kw">&lt;groupId&gt;</span>org.javalite<span class="kw">&lt;/groupId&gt;</span>
    <span class="kw">&lt;artifactId&gt;</span>activeweb-lessc-maven-plugin<span class="kw">&lt;/artifactId&gt;</span>
    <span class="kw">&lt;version&gt;</span>${activeweb.version}<span class="kw">&lt;/version&gt;</span>
    <span class="kw">&lt;configuration&gt;</span>
        <span class="kw">&lt;lesscMain&gt;</span>${basedir}/src/main/webapp/less/bootstrap.less<span class="kw">&lt;/lesscMain&gt;</span>
        <span class="kw">&lt;targetDirectory&gt;</span>${basedir}/target/web<span class="kw">&lt;/targetDirectory&gt;</span>
        <span class="kw">&lt;targetFileName&gt;</span>bootstrap.css<span class="kw">&lt;/targetFileName&gt;</span>
    <span class="kw">&lt;/configuration&gt;</span>
    <span class="kw">&lt;executions&gt;</span>
        <span class="kw">&lt;execution&gt;</span>
            <span class="kw">&lt;goals&gt;&lt;goal&gt;</span>compile<span class="kw">&lt;/goal&gt;&lt;/goals&gt;</span>
        <span class="kw">&lt;/execution&gt;</span>
    <span class="kw">&lt;/executions&gt;</span>
<span class="kw">&lt;/plugin&gt;</span></code></pre></td></tr></table></div>
<h2 id="configuration-for-multiple-less-files">Configuration for Multiple LESS files</h2>
<p>If your project has more than one LESS files, you can use alternative configuration to compile multiple files during the build:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;plugin&gt;</span>
    <span class="kw">&lt;groupId&gt;</span>org.javalite<span class="kw">&lt;/groupId&gt;</span>
    <span class="kw">&lt;artifactId&gt;</span>activeweb-lessc-maven-plugin<span class="kw">&lt;/artifactId&gt;</span>
    <span class="kw">&lt;version&gt;</span>${activeweb.version}<span class="kw">&lt;/version&gt;</span>
    <span class="kw">&lt;configuration&gt;</span>
        <span class="kw">&lt;lessConfigs&gt;</span>
            <span class="kw">&lt;lessConfig</span><span class="ot"> implementation=</span><span class="st">&quot;org.javalite.lessc.maven.LessConfig&quot;</span><span class="kw">&gt;</span>
                <span class="kw">&lt;lesscMain&gt;</span>src/main/webapp/less1/bootstrap.less<span class="kw">&lt;/lesscMain&gt;</span>
                <span class="kw">&lt;targetDirectory&gt;</span>target/web1<span class="kw">&lt;/targetDirectory&gt;</span>
                <span class="kw">&lt;targetFileName&gt;</span>bootstrap.css<span class="kw">&lt;/targetFileName&gt;</span>
                <span class="kw">&lt;lesscArguments&gt;</span>--modify-var=base-url=&#39;${build.number}&#39;<span class="kw">&lt;/lesscArguments&gt;</span>
            <span class="kw">&lt;/lessConfig&gt;</span>
            <span class="kw">&lt;lessConfig</span><span class="ot"> implementation=</span><span class="st">&quot;org.javalite.lessc.maven.LessConfig&quot;</span><span class="kw">&gt;</span>
                <span class="kw">&lt;lesscMain&gt;</span>src/main/webapp/less2/bootstrap.less<span class="kw">&lt;/lesscMain&gt;</span>
                <span class="kw">&lt;targetDirectory&gt;</span>target/web2<span class="kw">&lt;/targetDirectory&gt;</span>
                <span class="kw">&lt;targetFileName&gt;</span>bootstrap.css<span class="kw">&lt;/targetFileName&gt;</span>
                <span class="kw">&lt;lesscArguments&gt;</span>--modify-var=base-url=&#39;${build.number}&#39;<span class="kw">&lt;/lesscArguments&gt;</span>
            <span class="kw">&lt;/lessConfig&gt;</span>
        <span class="kw">&lt;/lessConfigs&gt;</span>
    <span class="kw">&lt;/configuration&gt;</span>
    <span class="kw">&lt;executions&gt;</span>
        <span class="kw">&lt;execution&gt;</span>
            <span class="kw">&lt;goals&gt;</span>
                <span class="kw">&lt;goal&gt;</span>compile<span class="kw">&lt;/goal&gt;</span>
            <span class="kw">&lt;/goals&gt;</span>
        <span class="kw">&lt;/execution&gt;</span>
    <span class="kw">&lt;/executions&gt;</span>
<span class="kw">&lt;/plugin&gt;</span></code></pre></td></tr></table></div>
<blockquote>
<p>The <code>lesscArguments</code> has an issue with quotes. Seems that the double quots are not needed.</p>
</blockquote>
<h2 id="package-the-css-into-war-file">Package the CSS into War file</h2>
<p>Configure to package the CSS file into the app with a War plugin:</p>
<div class="sourceCode"><table class="sourceCode xml numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="sourceCode"><pre><code class="sourceCode xml"><span class="kw">&lt;plugin&gt;</span>
    <span class="kw">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="kw">&lt;/groupId&gt;</span>
    <span class="kw">&lt;artifactId&gt;</span>maven-war-plugin<span class="kw">&lt;/artifactId&gt;</span>
    <span class="kw">&lt;version&gt;</span>2.4<span class="kw">&lt;/version&gt;</span>
    <span class="kw">&lt;configuration&gt;</span>
        <span class="kw">&lt;webResources&gt;</span>
            <span class="kw">&lt;resource&gt;</span>
                <span class="kw">&lt;directory&gt;</span>target/web<span class="kw">&lt;/directory&gt;</span>
            <span class="kw">&lt;/resource&gt;</span>
        <span class="kw">&lt;/webResources&gt;</span>
    <span class="kw">&lt;/configuration&gt;</span>
<span class="kw">&lt;/plugin&gt;</span></code></pre></td></tr></table></div>
<p>As a result, when your application is running in development environment, the <code>BootstrapController</code> is compiling CSS from less files in cases there are changes in the files. It checks for changes and re-compiles if needed on each request. During the build, the plugin fully compiles all Less files into a single target CSS file, which then gets packaged into the war file. The file <code>bootstrap.css</code> is then served from container, because this path is ignored in any environment except development. In fact, in a real production system this file like any other static files will be served by a web server or a CDN.</p>
